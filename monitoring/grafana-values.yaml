# Grafana standalone Helm values (alternative to kube-prometheus-stack)
# Install with: helm install grafana grafana/grafana -f monitoring/grafana-values.yaml

# Admin credentials
adminUser: admin
adminPassword: "changeme"  # Change in production!

# Resource configuration
resources:
  requests:
    cpu: 250m
    memory: 512Mi
  limits:
    cpu: 500m
    memory: 1Gi

# Persistence
persistence:
  enabled: true
  type: pvc
  size: 10Gi
  # storageClassName: gp3  # Uncomment for cloud provider
  accessModes:
    - ReadWriteOnce

# Datasources
datasources:
  datasources.yaml:
    apiVersion: 1
    datasources:
      - name: Prometheus
        type: prometheus
        url: http://prometheus-server:80
        access: proxy
        isDefault: true
        jsonData:
          timeInterval: 30s
      
      - name: Loki
        type: loki
        url: http://loki:3100
        access: proxy
        jsonData:
          maxLines: 1000

# Dashboard providers
dashboardProviders:
  dashboardproviders.yaml:
    apiVersion: 1
    providers:
      - name: 'default'
        orgId: 1
        folder: ''
        type: file
        disableDeletion: false
        editable: true
        options:
          path: /var/lib/grafana/dashboards/default
      
      - name: 'application'
        orgId: 1
        folder: 'Application Dashboards'
        type: file
        disableDeletion: false
        editable: true
        options:
          path: /var/lib/grafana/dashboards/application

# Load dashboards from files
dashboards:
  default:
    kubernetes-cluster:
      gnetId: 7249
      revision: 1
      datasource: Prometheus
    
    node-exporter:
      gnetId: 1860
      revision: 27
      datasource: Prometheus

# Ingress configuration
ingress:
  enabled: true
  ingressClassName: nginx
  annotations:
    cert-manager.io/cluster-issuer: "letsencrypt-prod"
    nginx.ingress.kubernetes.io/force-ssl-redirect: "true"
  
  hosts:
    - grafana.example.com
  
  tls:
    - secretName: grafana-tls
      hosts:
        - grafana.example.com

# Service configuration
service:
  type: ClusterIP
  port: 80

# Plugins to install
plugins:
  - grafana-piechart-panel
  - grafana-clock-panel

# SMTP / Email configuration (optional)
# smtp:
#   enabled: true
#   host: smtp.gmail.com:587
#   user: your-email@gmail.com
#   password: your-app-password
#   from_address: grafana@example.com
#   from_name: Grafana

# Grafana.ini configuration
grafana.ini:
  server:
    root_url: https://grafana.example.com
  
  analytics:
    reporting_enabled: false
    check_for_updates: false
  
  security:
    admin_user: admin
    # admin_password: set via adminPassword above
  
  auth.anonymous:
    enabled: false
  
  log:
    mode: console
    level: info

# Environment variables
env:
  GF_INSTALL_PLUGINS: ""

# Extra config maps for dashboards
extraConfigmapMounts:
  - name: app-dashboards
    mountPath: /var/lib/grafana/dashboards/application
    configMap: grafana-app-dashboards
    readOnly: true
